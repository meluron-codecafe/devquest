<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, maximum-scale=5.0">
<title>DevQuest</title>
<style>
    :root {
        --bg-color: #121212;
        --text-color: #e0e0e0;
        --container-bg: #1e1e1e;
        --border-color: #555;
        --hover-bg: #2a2a2a;
        --link-color: #4ea3ff;
        --topic-link-color: #aad4ff;
        --table-header-bg: #2b2b2b;
        --quote-color: #bbb;
        --footer-color: #999;
        
        /* Typography scale - enhanced for mobile */
        --font-size-xs: 12px;
        --font-size-sm: 13px;
        --font-size-base: 14px;
        --font-size-lg: 16px;
        --font-size-xl: 18px;
        --font-size-xxl: 20px;
        
        /* Spacing scale - optimized for touch */
        --space-xs: 4px;
        --space-sm: 8px;
        --space-md: 12px;
        --space-lg: 16px;
        --space-xl: 20px;
        --space-2xl: 24px;
        --space-3xl: 32px;
        
        /* Touch targets */
        --touch-target: 44px;
        --touch-target-sm: 40px;
        
        /* Border radius scale */
        --radius-sm: 4px;
        --radius-md: 6px;
        --radius-lg: 8px;
        --radius-xl: 12px;
        --radius-2xl: 16px;
    }
    
    body.light-theme {
        --bg-color: #f2f2f2;
        --text-color: #333;
        --container-bg: #fff;
        --border-color: #ccc;
        --hover-bg: #fafafa;
        --link-color: #0066cc;
        --topic-link-color: #0066cc;
        --table-header-bg: #f5f5f5;
        --quote-color: #777;
        --footer-color: #777;
    }

    * {
        box-sizing: border-box;
        -webkit-tap-highlight-color: rgba(0,0,0,0);
    }

    /* Remove focus outlines from all buttons and interactive elements */
    button:focus,
    a:focus,
    .filter-icon:focus,
    [role="button"]:focus {
        outline: none !important;
        box-shadow: none !important;
    }

    body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        font-size: var(--font-size-base);
        line-height: 1.5;
        background-color: var(--bg-color);
        color: var(--text-color);
        margin: 0;
        padding: var(--space-xl);
        transition: background-color 0.3s ease, color 0.3s ease;
        overflow-x: hidden;
    }
    
    .container {
        max-width: 900px;
        margin: 0 auto;
        background: var(--container-bg);
        border: 1px solid var(--border-color);
        border-radius: var(--radius-lg);
        padding: var(--space-2xl);
        box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        position: relative;
        transition: background 0.3s ease, border 0.3s ease;
    }
    
    .header {
        display: flex;
        justify-content: flex-start;
        align-items: center;
        margin-bottom: var(--space-2xl);
        position: relative;
        width: 100%;
        padding-top: 15px;
    }
    
    .logo {
        max-width: 140px;
        height: auto;
        display: block;
        transition: opacity 0.3s ease;
        margin-top: -23px;
    }

    @keyframes fadeIn {
        from { 
            opacity: 0; 
            transform: translateX(-50%) translateY(-5px); 
        }
        to { 
            opacity: 1; 
            transform: translateX(-50%) translateY(0); 
        }
    }

    /* ======= BUTTON CONTAINER ======= */
    .button-container {
        position: absolute;
        top: -15px;
        right: -15px;
        background: rgba(45, 45, 45, 0.95);
        border: 2px solid var(--border-color);
        border-radius: var(--radius-xl);
        padding: 2px;
        display: flex;
        z-index: 1000;
        backdrop-filter: blur(10px);
        box-shadow: 0 4px 20px rgba(0,0,0,0.15);
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        align-items: center;
    }

    /* ======= SEARCH FUNCTIONALITY ======= */
    .search-container {
        position: relative;
        display: flex;
        align-items: center;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        min-width: 40px;
    }

    .button-container.search-expanded {
        padding-left: 240px;
    }

    .search-btn {
        background: transparent !important;
        color: var(--text-color);
        border: none !important;
        border-radius: 50%;
        width: var(--touch-target-sm);
        height: var(--touch-target-sm);
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: var(--font-size-lg);
        transition: all 0.3s ease;
        text-decoration: none;
        flex-shrink: 0;
        z-index: 1002;
        position: relative;
        min-height: var(--touch-target-sm);
        min-width: var(--touch-target-sm);
    }

    .search-btn:hover {
        background: rgba(255, 255, 255, 0.1) !important;
        color: var(--text-color) !important;
        text-decoration: none !important;
    }

    .search-btn.active {
        background: rgba(255, 255, 255, 0.1) !important;
    }

    .search-input-container {
        position: absolute;
        right: 2px;
        top: 2px;
        height: 36px;
        width: 36px;
        overflow: visible;
        transition: width 0.3s cubic-bezier(0.4, 0, 0.2, 1), padding 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        background: transparent;
        border-radius: calc(var(--radius-xl) - 2px);
        display: flex;
        align-items: center;
        z-index: 1001;
        border: none;
    }

    .search-input-container.expanded {
        width: 270px;
        padding-left: 8px;
        padding-right: 44px;
    }

    .search-input {
        width: 100%;
        height: 32px;
        background: transparent;
        border: none;
        outline: none;
        color: var(--text-color);
        font-size: var(--font-size-sm);
        font-family: inherit;
        padding: 0 0px;
        opacity: 0;
        transition: opacity 0.3s ease 0.1s;
        border-radius: 0;
    }

    .search-input-container.expanded .search-input {
        opacity: 1;
    }

    .search-input::placeholder {
        color: rgba(224, 224, 224, 0.5);
    }

    .search-input:focus {
        outline: none;
        box-shadow: none;
        background: transparent;
        border: none;
    }

    body.light-theme .button-container {
        background: rgba(255, 255, 255, 0.95);
        border-color: var(--border-color);
        box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    }

    body.light-theme .search-input::placeholder {
        color: rgba(51, 51, 51, 0.5);
    }

    body.light-theme .search-btn:hover,
    body.light-theme .search-btn:focus {
        background: rgba(0, 0, 0, 0.05) !important;
    }
    
    /* ======= THEME TOGGLE BUTTON STYLES ======= */
    .theme-toggle-btn {
        background: transparent;
        border: none;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: var(--font-size-xl);
        transition: all 0.3s ease;
        color: var(--text-color);
        position: relative;
        overflow: hidden;
        min-height: var(--touch-target-sm);
        min-width: var(--touch-target-sm);
    }

    .theme-toggle-btn:hover {
        background: rgba(255, 255, 255, 0.1);
    }

    .theme-icon {
        position: absolute;
        opacity: 0;
        transform: scale(0.5) rotate(180deg);
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        display: flex;
        align-items: center;
        justify-content: center;
        width: 24px;
        height: 24px;
    }

    .theme-icon.active {
        opacity: 1;
        transform: scale(1) rotate(0deg);
    }

    .theme-icon svg {
        width: 20px;
        height: 20px;
        stroke: currentColor;
        fill: none;
        transition: all 0.2s ease;
    }

    .github-btn, .about-btn {
        background: transparent !important;
        color: var(--text-color);
        border: none !important;
        border-radius: 50%;
        width: var(--touch-target-sm);
        height: var(--touch-target-sm);
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: var(--font-size-lg);
        transition: all 0.3s ease;
        text-decoration: none;
        min-height: var(--touch-target-sm);
        min-width: var(--touch-target-sm);
    }

    .github-btn:hover, .about-btn:hover {
        background: rgba(255, 255, 255, 0.1) !important;
        color: var(--text-color) !important;
        text-decoration: none !important;
    }

    body.light-theme .theme-toggle-btn:hover,
    body.light-theme .github-btn:hover,
    body.light-theme .about-btn:hover {
        background: rgba(0, 0, 0, 0.05);
    }
    
    input {
        padding: var(--space-sm) var(--space-md);
        font-size: var(--font-size-base);
        font-family: inherit;
        border: 1px solid var(--border-color);
        border-radius: var(--radius-sm);
        background: var(--container-bg);
        color: var(--text-color);
        transition: all 0.3s ease;
        min-height: var(--touch-target);
    }
    
    input:focus {
        outline: none;
        border-color: var(--link-color);
        box-shadow: 0 0 0 2px rgba(78, 163, 255, 0.2);
    }
    
    .table-wrapper {
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
        scroll-behavior: smooth;
        border-radius: var(--radius-lg);
    }
    
    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: var(--space-md);
        border-radius: var(--radius-md);
        overflow: hidden;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    
    th, td {
        border-bottom: 1px solid var(--border-color);
        padding: var(--space-md) var(--space-lg);
        text-align: left;
        font-size: var(--font-size-base);
        line-height: 1.4;
    }
    
    th {
        background-color: var(--table-header-bg);
        color: var(--text-color);
        font-weight: 600;
        font-size: var(--font-size-sm);
        text-transform: uppercase;
        letter-spacing: 0.5px;
        position: relative;
    }
    
    tr:hover {
        background-color: var(--hover-bg);
    }
    
    tr:last-child td {
        border-bottom: none;
    }
    
    a {
        color: var(--link-color);
        text-decoration: none;
        transition: color 0.2s ease;
    }
    
    a:hover, a:focus {
        text-decoration: underline;
        color: #66b3ff;
        outline: none;
    }

    .category-header {
        display: flex;
        align-items: center;
        gap: var(--space-sm);
    }
    
    .filter-icon {
        display: inline-flex;
        justify-content: center;
        align-items: center;
        width: 20px;
        height: 20px;
        border-radius: 50%;
        border: 1px solid #fd8a09;
        background: transparent;
        color: #fd8a09;
        cursor: pointer;
        transition: all 0.2s ease;
        padding: 2px;
    }
    
    .filter-icon:hover {
        background: #fd8a09;
        color: white;
    }

    .filter-icon.active {
        background: #fd8a09;
        color: white;
    }

    .filter-icon svg {
        width: 12px;
        height: 12px;
        stroke: currentColor;
        fill: none;
    }

    .category-filter-dropdown {
        position: absolute;
        background: var(--container-bg);
        border: 2px solid var(--border-color);
        border-radius: var(--radius-md);
        box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        z-index: 1000;
        max-width: 200px;
        font-size: var(--font-size-sm);
        line-height: 1.5;
        display: none;
        backdrop-filter: blur(10px);
        max-height: 50vh;
        overflow-y: auto;
    }
    
    .category-filter-dropdown.visible {
        display: block;
        animation: fadeInUp 0.3s ease;
    }

    .filter-option {
        padding: var(--space-md) var(--space-lg);
        cursor: pointer;
        transition: background-color 0.2s ease;
        border-bottom: 1px solid var(--border-color);
        min-height: var(--touch-target);
        display: flex;
        align-items: center;
    }

    .filter-option:last-child {
        border-bottom: none;
    }

    .filter-option:hover, .filter-option:focus {
        background-color: var(--hover-bg);
        outline: none;
    }

    .filter-option.active {
        background-color: var(--link-color);
        color: white;
    }

    .no-results {
        text-align: center;
        padding: var(--space-3xl);
        color: var(--quote-color);
        font-style: italic;
        border: 2px dashed var(--border-color);
        border-radius: var(--radius-lg);
        margin-top: var(--space-lg);
        font-size: var(--font-size-lg);
    }

    .no-results .request-link {
        color: var(--quote-color);
        text-decoration: underline;
        font-weight: normal;
        margin-top: var(--space-lg);
        display: inline-block;
        transition: color 0.3s ease;
        cursor: pointer;
        font-size: var(--font-size-base);
        padding: var(--space-md) var(--space-lg);
        border: 1px solid var(--border-color);
        border-radius: var(--radius-md);
        background: var(--container-bg);
        min-height: var(--touch-target);
    }

    .no-results .request-link:hover, .no-results .request-link:focus {
        color: #fd8a09;
        background: var(--hover-bg);
        outline: none;
        transform: translateY(-1px);
    }

    .about-modal {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 2000;
        backdrop-filter: blur(0px);
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s ease;
        padding: var(--space-lg);
    }

    .about-modal.visible {
        background: rgba(0, 0, 0, 0.7);
        backdrop-filter: blur(5px);
        opacity: 1;
        visibility: visible;
    }

    .about-modal-content {
        background: var(--container-bg);
        border: 2px solid var(--border-color);
        border-radius: var(--radius-xl);
        padding: var(--space-2xl);
        max-width: 600px;
        width: 100%;
        max-height: calc(100vh - 2 * var(--space-lg));
        overflow-y: auto;
        position: relative;
        box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        transform: scale(0.95);
        opacity: 0;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .about-modal.visible .about-modal-content {
        transform: scale(1);
        opacity: 1;
    }

    .about-modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: var(--space-xl);
        padding-bottom: var(--space-lg);
        border-bottom: 2px solid var(--border-color);
    }

    .about-modal-title {
        font-size: var(--font-size-xl);
        font-weight: 600;
        color: var(--link-color);
        margin: 0;
        display: flex;
        align-items: center;
        gap: var(--space-md);
    }

    .about-modal-close {
        background: transparent;
        border: none;
        font-size: 24px;
        cursor: pointer;
        color: var(--text-color);
        width: var(--touch-target);
        height: var(--touch-target);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s ease;
    }

    .about-modal-close:hover, .about-modal-close:focus {
        background: var(--hover-bg);
        outline: none;
        transform: scale(1.1);
    }

    .about-modal-body {
        line-height: 1.6;
        color: var(--text-color);
        font-size: var(--font-size-base);
    }

    .about-section {
        margin-bottom: var(--space-xl);
    }

    .about-section:last-child {
        margin-bottom: 0;
    }

    .about-section h3 {
        font-size: var(--font-size-lg);
        font-weight: 600;
        color: var(--link-color);
        margin: 0 0 var(--space-md) 0;
        display: flex;
        align-items: center;
        gap: var(--space-sm);
    }

    .about-section p {
        margin: 0 0 var(--space-md) 0;
        color: var(--text-color);
        font-size: var(--font-size-base);
    }

    .about-section p:last-child {
        margin-bottom: 0;
    }

    .about-section ul {
        margin: var(--space-md) 0;
        padding-left: var(--space-xl);
    }

    .about-section li {
        margin-bottom: var(--space-sm);
        color: var(--text-color);
        font-size: var(--font-size-base);
    }

    .about-highlight {
        color: var(--link-color);
        font-weight: 600;
    }

    .about-tech-stack {
        display: flex;
        flex-wrap: wrap;
        gap: var(--space-sm);
        margin: var(--space-md) 0;
    }

    .tech-tag {
        background: rgba(77, 163, 255, 0.1);
        border: 1px solid rgba(77, 163, 255, 0.3);
        color: var(--link-color);
        padding: var(--space-sm) var(--space-md);
        border-radius: var(--radius-sm);
        font-size: var(--font-size-sm);
        font-weight: 500;
    }

    body.light-theme .tech-tag {
        background: rgba(77, 163, 255, 0.05);
        border-color: rgba(77, 163, 255, 0.2);
    }

    .preview-tooltip {
        position: absolute;
        background: var(--container-bg);
        border: 2px solid var(--border-color);
        border-radius: var(--radius-lg);
        padding: var(--space-lg);
        box-shadow: 0 12px 35px rgba(0,0,0,0.25);
        z-index: 1001;
        max-width: 500px;
        font-size: var(--font-size-sm);
        line-height: 1.4;
        display: none;
        backdrop-filter: blur(10px);
    }
    
    .preview-tooltip.visible {
        display: block;
        animation: fadeInUp 0.3s ease;
    }
    
    @keyframes fadeInUp {
        from { 
            opacity: 0; 
            transform: translateY(10px);
        }
        to { 
            opacity: 1; 
            transform: translateY(0);
        }
    }
    
    .preview-tooltip .preview-title {
        font-weight: 600;
        color: var(--link-color);
        margin-bottom: var(--space-md);
        font-size: var(--font-size-base);
        border-bottom: 1px solid var(--border-color);
        padding-bottom: var(--space-sm);
        display: flex;
        align-items: center;
        gap: var(--space-sm);
    }

    .preview-tooltip .quest-icon {
        color: #fd8a09;
        font-size: var(--font-size-lg);
    }
    
    .preview-tooltip .quest-section {
        margin-bottom: var(--space-md);
    }
    
    .preview-tooltip .quest-section:last-child {
        margin-bottom: 0;
    }
    
    .preview-tooltip .quest-list {
        list-style: none;
        padding: 0;
        margin: var(--space-sm) 0;
    }

    .preview-tooltip .quest-item {
        background: rgba(78, 163, 255, 0.05);
        border-left: 3px solid var(--link-color);
        margin: var(--space-xs) 0;
        padding: var(--space-sm) var(--space-md);
        border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
        color: var(--text-color);
        font-size: var(--font-size-sm);
        line-height: 1.4;
    }

    body.light-theme .preview-tooltip .quest-item {
        background: rgba(78, 163, 255, 0.03);
    }

    .preview-tooltip .quest-item .item-number {
        color: var(--link-color);
        font-weight: 600;
        margin-right: var(--space-xs);
    }
    
    .preview-tooltip .quest-content img {
        max-width: 100%;
        height: auto;
        max-height: 200px;
        border-radius: var(--radius-sm);
        margin: var(--space-sm) 0;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        object-fit: contain;
    }
    
    .preview-tooltip .loading {
        text-align: center;
        color: var(--quote-color);
        font-style: italic;
        font-size: var(--font-size-sm);
    }
    
    .preview-tooltip .error {
        text-align: center;
        color: #f87171;
        font-style: italic;
        font-size: var(--font-size-sm);
    }
    
    .footer {
        text-align: center;
        margin-top: var(--space-2xl);
        padding: var(--space-xl) var(--space-md);
        border-top: 1px solid var(--border-color);
        color: var(--footer-color);
        font-size: var(--font-size-base);
        line-height: 1.6;
    }
    
    .footer a {
        color: #fd8a09;
        text-decoration: none;
        font-weight: 500;
        padding: var(--space-xs);
        border-radius: var(--radius-sm);
        min-height: var(--touch-target);
        display: inline-flex;
        align-items: center;
    }
    
    .footer a:hover, .footer a:focus {
        text-decoration: underline;
        background: rgba(253, 138, 9, 0.1);
        outline: none;
    }
    
    #tutorialTable a {
        color: var(--topic-link-color);
        text-decoration: none;
        font-weight: 500;
        transition: all 0.2s ease;
    }
    
    #tutorialTable a:hover, #tutorialTable a:focus {
        text-decoration: underline;
        color: #4ea3ff;
    }
    
    .category {
        font-weight: 600;
        font-size: var(--font-size-sm);
        letter-spacing: 0.5px;
    }
    
    /* Mobile-first responsive design */
    @media (max-width: 768px) {
        :root {
            --font-size-base: 16px;
            --font-size-lg: 18px;
            --font-size-xl: 20px;
            --font-size-xxl: 22px;
            --space-md: 16px;
            --space-lg: 20px;
            --space-xl: 24px;
            --space-2xl: 28px;
            --space-3xl: 36px;
        }

        body {
            padding: var(--space-md);
            font-size: var(--font-size-base);
        }
        
        .container {
            padding: var(--space-lg);
            margin: 0;
            border-radius: var(--radius-lg);
        }
        
        .header {
            flex-direction: column;
            align-items: center;
            gap: var(--space-xl);
            margin-bottom: var(--space-2xl);
            padding-top: 0;
        }
        
        .logo {
            max-width: 130px;
            margin-top: 0;
        }
        
        .button-container {
            position: relative;
            top: 0;
            right: 0;
            background: var(--container-bg);
            border: 2px solid var(--border-color);
            border-radius: var(--radius-xl);
            padding: var(--space-sm);
            display: flex;
            flex-direction: row;
            gap: var(--space-sm);
            width: auto;
            max-width: none;
            justify-content: center;
            box-shadow: 0 4px 16px rgba(0,0,0,0.15);
        }

        .button-container.search-expanded {
            padding-left: calc(100vw - 240px);
        }

        .search-container {
            position: relative;
            display: flex;
            align-items: center;
        }

        .search-input-container {
            position: absolute;
            right: 0px;
            top: 0px;
            height: var(--touch-target);
            width: var(--touch-target);
            overflow: visible;
            transition: width 0.3s cubic-bezier(0.4, 0, 0.2, 1), padding 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            background: transparent;
            border-radius: calc(var(--radius-xl) - 2px);
            display: flex;
            align-items: center;
            z-index: 1001;
            border: none;
        }

        .search-input-container.expanded {
            width: calc(100vw - 220px);
            padding-left: 0;
            padding-right: var(--touch-target);
        }

        .search-input {
            width: 100%;
            height: calc(var(--touch-target) - 8px);
            background: transparent;
            border: none;
            outline: none;
            color: var(--text-color);
            font-size: var(--font-size-base);
            font-family: inherit;
            padding: 0 0px;
            opacity: 0;
            transition: opacity 0.3s ease 0.1s;
            border-radius: 0;
        }

        .search-input-container.expanded .search-input {
            opacity: 1;
        }

        /* COMPLETE MOBILE BUTTON FIX - Remove all constraints */
        @media (max-width: 768px) {
            .search-container {
                min-width: 44px !important;
                width: 44px !important;
                height: 44px !important;
            }
            
            .search-input-container {
                position: absolute;
                right: 0px !important;
                top: 0px !important;
                height: 44px !important;
                width: 44px !important;
                min-width: 44px !important;
                min-height: 44px !important;
            }
            
            .search-input-container.expanded {
                width: calc(100vw - 220px) !important;
                padding-right: 44px !important;
            }
            
            /* Force all buttons to exact same size */
            #searchBtn,
            #aboutBtn, 
            #themeToggle,
            .github-btn {
                width: 44px !important;
                height: 44px !important;
                min-width: 44px !important;
                min-height: 44px !important;
                max-width: 44px !important;
                max-height: 44px !important;
                font-size: 18px !important;
                border-radius: 8px !important;
                padding: 0 !important;
                margin: 0 !important;
                box-sizing: border-box !important;
                position: relative !important;
                flex-shrink: 0 !important;
                display: flex !important;
                align-items: center !important;
                justify-content: center !important;
            }
            
            #searchBtn svg,
            #aboutBtn svg,
            #themeToggle svg,
            .github-btn svg {
                width: 24px !important;
                height: 24px !important;
                flex-shrink: 0 !important;
            }
        }

        .search-btn svg,
        .about-btn svg,
        .theme-toggle-btn svg,
        .github-btn svg {
            width: 24px !important;
            height: 24px !important;
        }

        .search-btn:hover {
            background: rgba(255, 255, 255, 0.1) !important;
            color: var(--text-color) !important;
            text-decoration: none !important;
        }

        .search-btn.active {
            background: rgba(255, 255, 255, 0.1) !important;
        }
        
        .filter-icon {
            width: 24px;
            height: 24px;
            min-width: var(--touch-target-sm);
            min-height: var(--touch-target-sm);
        }
        
        .filter-icon:hover {
            background: #fd8a09;
            color: white;
            transform: scale(1.05);
        }
        
        .category-filter-dropdown {
            max-width: 320px;
            font-size: var(--font-size-base);
            left: 50% !important;
            transform: translateX(-50%);
        }
        
        .table-wrapper {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            margin: var(--space-lg) 0;
            border-radius: var(--radius-lg);
            box-shadow: 0 2px 12px rgba(0,0,0,0.1);
        }
        
        table {
            min-width: 650px;
            margin: 0;
        }
        
        th, td {
            padding: var(--space-lg) var(--space-md);
            font-size: var(--font-size-base);
            white-space: nowrap;
        }

        th:first-child, td:first-child {
            min-width: 100px;
        }

        th:nth-child(2), td:nth-child(2) {
            min-width: 250px;
            white-space: normal;
        }

        th:nth-child(3), td:nth-child(3) {
            min-width: 180px;
            white-space: normal;
        }

        .about-modal {
            padding: var(--space-md);
        }

        .about-modal-content {
            width: 100%;
            padding: var(--space-xl);
            max-height: calc(100vh - 2 * var(--space-md));
            border-radius: var(--radius-xl);
        }

        .about-modal-title {
            font-size: var(--font-size-xl);
        }

        .about-section h3 {
            font-size: var(--font-size-lg);
        }

        .preview-tooltip {
            max-width: calc(100vw - 2 * var(--space-md));
            left: var(--space-md) !important;
            right: var(--space-md);
            font-size: var(--font-size-sm);
            padding: var(--space-md);
            border-radius: var(--radius-md);
        }

        .preview-tooltip .preview-title {
            font-size: var(--font-size-sm);
            margin-bottom: var(--space-sm);
            padding-bottom: var(--space-xs);
        }

        .preview-tooltip .quest-section {
            margin-bottom: var(--space-sm);
        }

        .preview-tooltip .quest-item,
        .preview-tooltip div[style*="margin: 8px 0"] {
            margin: var(--space-xs) 0 !important;
            padding: var(--space-xs) var(--space-sm) !important;
            font-size: var(--font-size-xs) !important;
            line-height: 1.3 !important;
        }

        .preview-tooltip .loading,
        .preview-tooltip .error {
            font-size: var(--font-size-xs);
            padding: var(--space-sm);
        }

        .preview-tooltip .quest-content img {
            max-height: 100px !important;
            margin: var(--space-xs) 0 !important;
        }

        .footer {
            font-size: var(--font-size-xs);
            padding: var(--space-lg) var(--space-sm);
            line-height: 1.4;
        }

        .footer a {
            font-size: var(--font-size-xs);
            padding: var(--space-xs) var(--space-sm);
            min-height: var(--touch-target-sm);
        }

        .no-results {
            padding: var(--space-2xl);
            font-size: var(--font-size-lg);
        }

        .no-results .request-link {
            font-size: var(--font-size-base);
            padding: var(--space-lg);
            margin-top: var(--space-xl);
            min-height: var(--touch-target);
        }
    }

    @media (max-width: 480px) {
        :root {
            --space-sm: 12px;
            --space-md: 16px;
            --space-lg: 20px;
            --space-xl: 24px;
            --space-2xl: 32px;
            --space-3xl: 40px;
        }

        body {
            padding: var(--space-sm);
        }

        .container {
            padding: var(--space-md);
            border-radius: var(--radius-md);
        }

        .logo {
            max-width: 120px;
        }

        .button-container {
            max-width: 320px;
            gap: var(--space-xs);
            padding: var(--space-xs);
        }

        .search-container {
            max-width: 180px;
        }

        .search-input-container {
            height: var(--touch-target-sm);
        }

        .search-input {
            height: calc(var(--touch-target-sm) - 2px);
            font-size: var(--font-size-sm);
        }

        .search-input-container.expanded {
            padding-left: var(--space-md);
            padding-right: 48px;
        }

        /* FIXED: Ensure buttons maintain proper size on small screens */
        .search-btn,
        .about-btn,
        .theme-toggle-btn,
        .github-btn {
            width: var(--touch-target) !important;
            height: var(--touch-target) !important;
            min-width: var(--touch-target) !important;
            min-height: var(--touch-target) !important;
        }

        .about-modal {
            padding: var(--space-sm);
        }

        .about-modal-content {
            width: 100%;
            padding: var(--space-lg);
            max-height: calc(100vh - 2 * var(--space-sm));
        }

        .about-section {
            margin-bottom: var(--space-lg);
        }

        .preview-tooltip {
            max-width: calc(100vw - 2 * var(--space-md));
            left: var(--space-md) !important;
            font-size: var(--font-size-base);
        }

        .footer {
            padding: var(--space-xl) var(--space-sm);
        }
    }

    /* Ultra-small screens - stack table data */
    @media (max-width: 400px) {
        table, thead, tbody, th, td, tr {
            display: block;
        }
        
        table {
            min-width: auto;
        }
        
        thead tr {
            position: absolute;
            top: -9999px;
            left: -9999px;
        }
        
        tr {
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            margin-bottom: var(--space-sm);
            padding: var(--space-sm);
            background: var(--container-bg);
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        td {
            border: none;
            border-bottom: 1px solid rgba(255,255,255,0.05);
            position: relative;
            padding: var(--space-xs) 0;
            white-space: normal;
            min-width: auto;
            display: block;
        }
        
        td:before {
            content: attr(data-label);
            display: block;
            font-weight: 600;
            color: var(--quote-color);
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 2px;
        }
        
        td:last-child {
            border-bottom: none;
            padding-bottom: 0;
        }

        /* Category styling in mobile cards */
        td[data-label="Category"]:before {
            color: var(--quote-color);
        }
        
        td[data-label="Topic"] a {
            font-size: var(--font-size-sm);
            font-weight: 500;
            line-height: 1.3;
            display: block;
            padding: 2px 0;
        }
        
        td[data-label="Keywords"] {
            font-size: 12px;
            color: var(--quote-color);
            font-style: italic;
            line-height: 1.2;
        }
        
        .container {
            padding: var(--space-xs);
        }
        
        .header {
            gap: var(--space-sm);
            margin-bottom: var(--space-md);
        }
        
        .table-wrapper {
            margin: var(--space-sm) 0;
        }
    }

    /* Light theme mobile adjustments */
    body.light-theme .button-container {
        background: var(--container-bg);
        box-shadow: 0 4px 16px rgba(0,0,0,0.1);
    }

    /* Enhanced accessibility for mobile */
    @media (max-width: 768px) {
        *:focus {
            outline: 2px solid var(--link-color);
            outline-offset: 2px;
        }

        button:focus,
        a:focus,
        input:focus {
            outline: 2px solid var(--link-color);
            outline-offset: 2px;
        }
    }

    /* Reduce motion for users who prefer it */
    @media (prefers-reduced-motion: reduce) {
        *,
        *::before,
        *::after {
            animation-duration: 0.01ms !important;
            animation-iteration-count: 1 !important;
            transition-duration: 0.01ms !important;
            scroll-behavior: auto !important;
        }
    }
</style>
</head>
<body>
<div class="container">
    <!-- Header -->
    <div class="header">
        <img src="https://raw.githubusercontent.com/meluron/assets/refs/heads/main/logos/meluron-codecafe/DevQuest/icon_with_text.png" class="logo" id="logo" alt="DevQuest Logo">
        <div class="button-container">
            <!-- Search functionality -->
            <div class="search-container">
                <div class="search-input-container" id="searchInputContainer">
                    <input type="text" class="search-input" id="searchBox" placeholder="Search topics or keywords..." aria-label="Search tutorials">
                </div>
                <button id="searchBtn" class="search-btn" title="Search" aria-label="Toggle search">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="11" cy="11" r="8"></circle>
                        <path d="m21 21-4.35-4.35"></path>
                    </svg>
                </button>
            </div>
            
            <button id="aboutBtn" class="about-btn" title="About DevQuest" aria-label="About DevQuest">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="10"></circle>
                    <path d="M12 16v-4"></path>
                    <path d="M12 8h.01"></path>
                </svg>
            </button>
            <button id="themeToggle" class="theme-toggle-btn" title="Toggle theme" aria-label="Toggle dark/light theme">
                <div class="theme-icon dark">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                </div>
                <div class="theme-icon light">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </div>
            </button>
            <a href="https://github.com/meluron-codecafe/DevQuest" target="_blank" class="github-btn" title="View on GitHub" aria-label="View DevQuest on GitHub">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                </svg>
            </a>
        </div>
    </div>

    <div class="table-wrapper">
        <table id="tutorialTable">
            <thead>
                <tr>
                    <th>
                        <div class="category-header">
                            Category
                            <span class="filter-icon" id="categoryFilter" title="Filter by category" aria-label="Filter by category" tabindex="0" role="button">
                                <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <polygon points="22,3 2,3 10,12.46 10,19 14,21 14,12.46"></polygon>
                                </svg>
                            </span>
                        </div>
                    </th>
                    <th>Topic</th>
                    <th>Keywords</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>

    <!-- No results message -->
    <div id="noResults" class="no-results" style="display: none;">
        <div>No tutorials found for your search.</div>
        <span id="requestTopicLink" class="request-link" role="button" tabindex="0">Click here to request this topic</span>
    </div>

    <!-- About modal -->
    <div id="aboutModal" class="about-modal" role="dialog" aria-labelledby="aboutModalTitle" aria-hidden="true">
        <div class="about-modal-content">
            <div class="about-modal-header">
                <h2 class="about-modal-title" id="aboutModalTitle">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="10"></circle>
                        <path d="M12 16v-4"></path>
                        <path d="M12 8h.01"></path>
                    </svg>
                    About devQuest
                </h2>
                <button class="about-modal-close" id="aboutModalClose" aria-label="Close about modal">&times;</button>
            </div>
            <div class="about-modal-body">
                <div class="about-section">
                    <p>devQuest offers <strong>Python</strong>, <strong>Audio DSP</strong>, and <strong>AI/ML</strong> tutorials through Jupyter notebooks.</p>
                </div>
                
                <div class="about-section">
                    <h3>Categories</h3>
                    <p><strong>EXP (Experiments):</strong> Conducting experiments, exploring ideas, and uncovering insights on various topics.</p>
                    <p><strong>P2C (Paper to Code):</strong> Breaking down research papers into practical, working implementations.</p>
                    <p><strong>M4CS (Math for CS):</strong> Exploring mathematical concepts that form the backbone of computer science.</p>
                    <p><strong>TOOL:</strong> Discovering and experimenting with tools to solve real-world problems efficiently.</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Category filter dropdown -->
    <div id="categoryFilterDropdown" class="category-filter-dropdown" role="listbox"></div>
    
    <!-- Preview tooltip for topics -->
    <div id="previewTooltip" class="preview-tooltip" role="tooltip"></div>
    
</div>
    
<div class="footer">
    An initiative by <a href="https://github.com/meluron" target="_blank">meluron</a> to bring context to learning.
</div>

<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

<script>
    // Category colors for dark theme
    const categoryColorsDark = [
        "#fd8a09", "#4ade80", "#60a5fa", "#f472b6", "#facc15", "#a78bfa", "#34d399", "#f87171"
    ];
    
    // Category colors for light theme
    const categoryColorsLight = [
        "#dc6803", "#15803d", "#2563eb", "#db2777", "#ca8a04", "#7c3aed", "#0f766e", "#dc2626"
    ];
    
    let tutorials = [];
    let currentCategoryFilter = '';
    let searchExpanded = false;
    
    const categoryColorMap = {};
    
    function assignCategoryColors() {
        const uniqueCategories = [...new Set(tutorials.map(t => t.category))].sort();
        const colors = currentTheme === 'light' ? categoryColorsLight : categoryColorsDark;
        uniqueCategories.forEach((cat, idx) => {
            categoryColorMap[cat] = colors[idx % colors.length];
        });
    }
    
    let searchBtn, searchInputContainer, searchBox;
    
    function initializeSearch() {
        searchBtn = document.getElementById("searchBtn");
        searchInputContainer = document.getElementById("searchInputContainer");
        searchBox = document.getElementById("searchBox");
        
        if (searchBtn && searchInputContainer && searchBox) {
            searchBtn.addEventListener("click", function(e) {
                e.preventDefault();
                e.stopPropagation();
                toggleSearch();
            });
            
            // Add touch event for better mobile experience
            searchBtn.addEventListener("touchend", function(e) {
                e.preventDefault();
                e.stopPropagation();
                toggleSearch();
            });
            
            // Add keyboard support for search button
            searchBtn.addEventListener("keydown", function(e) {
                if (e.key === "Enter" || e.key === " ") {
                    e.preventDefault();
                    toggleSearch();
                }
            });

            // Auto-expand search when input is clicked on mobile
            searchBox.addEventListener("click", function(e) {
                if (window.innerWidth <= 768 && !searchExpanded) {
                    e.preventDefault();
                    toggleSearch();
                }
            });
        }
    }
    
    function toggleSearch() {
        searchExpanded = !searchExpanded;
        
        const buttonContainer = document.querySelector('.button-container');
        const isMobile = window.innerWidth <= 768;
        
        if (searchExpanded) {
            searchInputContainer.classList.add("expanded");
            searchBtn.classList.add("active");
            buttonContainer.classList.add("search-expanded");
            
            // Auto-focus immediately on mobile, with delay on desktop
            if (isMobile) {
                setTimeout(() => {
                    searchBox.focus();
                    // Ensure virtual keyboard appears on mobile
                    searchBox.click();
                }, 100);
            } else {
                setTimeout(() => {
                    searchBox.focus();
                }, 300);
            }
        } else {
            searchInputContainer.classList.remove("expanded");
            searchBtn.classList.remove("active");
            buttonContainer.classList.remove("search-expanded");
            searchBox.blur();
        }
    }
    
    // Enhanced click outside behavior
    document.addEventListener("click", (e) => {
        if (searchBtn && searchInputContainer && 
            !searchBtn.contains(e.target) && !searchInputContainer.contains(e.target)) {
            if (searchExpanded) {
                searchExpanded = false;
                searchInputContainer.classList.remove("expanded");
                searchBtn.classList.remove("active");
                document.querySelector('.button-container').classList.remove("search-expanded");
            }
        }
    });
    
    document.addEventListener("keydown", (e) => {
        if (e.key === "Escape" && searchExpanded) {
            toggleSearch();
        }
    });
    
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initializeSearch);
    } else {
        initializeSearch();
    }
    
    // Theme management
    let currentTheme = 'dark';
    
    const themeToggle = document.getElementById("themeToggle");
    const themeIcons = {
        dark: document.querySelector(".theme-icon.dark"),
        light: document.querySelector(".theme-icon.light")
    };
    
    function getSystemTheme() {
        return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
    }
    
    function applyTheme(theme) {
        document.body.classList.remove('light-theme', 'dark-theme');
        
        if (theme === 'light') {
            document.body.classList.add('light-theme');
        } else {
            document.body.classList.add('dark-theme');
        }
    }
    
    function updateThemeToggle() {
        Object.keys(themeIcons).forEach(function(key) {
            themeIcons[key].classList.remove('active');
        });
        
        themeIcons[currentTheme].classList.add('active');
        
        var themeNames = {
            dark: 'Theme: Dark',
            light: 'Theme: Light'
        };
        themeToggle.title = themeNames[currentTheme];
    }
    
    function toggleTheme() {
        currentTheme = currentTheme === 'dark' ? 'light' : 'dark';
        
        applyTheme(currentTheme);
        updateThemeToggle();
        
        if (tutorials.length > 0) {
            assignCategoryColors();
            renderTable();
            setTimeout(addPreviewListeners, 100);
        }
        
        localStorage.setItem('theme-preference', currentTheme);
    }
    
    themeToggle.addEventListener("click", toggleTheme);
    
    // Add keyboard support for theme toggle
    themeToggle.addEventListener("keydown", function(e) {
        if (e.key === "Enter" || e.key === " ") {
            e.preventDefault();
            toggleTheme();
        }
    });
    
    currentTheme = getSystemTheme();
    applyTheme(currentTheme);
    updateThemeToggle();
    
    window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', function(e) {
        currentTheme = getSystemTheme();
        applyTheme(currentTheme);
        updateThemeToggle();
        
        if (tutorials.length > 0) {
            assignCategoryColors();
            renderTable();
            setTimeout(addPreviewListeners, 100);
        }
        
        localStorage.removeItem('theme-preference');
    });
    
    // About modal with enhanced accessibility
    const aboutBtn = document.getElementById("aboutBtn");
    const aboutModal = document.getElementById("aboutModal");
    const aboutModalClose = document.getElementById("aboutModalClose");
    
    aboutBtn.addEventListener("click", openAboutModal);
    aboutBtn.addEventListener("keydown", function(e) {
        if (e.key === "Enter" || e.key === " ") {
            e.preventDefault();
            openAboutModal();
        }
    });
    
    function openAboutModal() {
        aboutModal.classList.add("visible");
        aboutModal.setAttribute("aria-hidden", "false");
        document.body.style.overflow = "hidden";
        aboutModalClose.focus();
    }
    
    function closeAboutModal() {
        aboutModal.classList.remove("visible");
        aboutModal.setAttribute("aria-hidden", "true");
        document.body.style.overflow = "";
        aboutBtn.focus();
    }
    
    aboutModalClose.addEventListener("click", closeAboutModal);
    aboutModalClose.addEventListener("keydown", function(e) {
        if (e.key === "Enter" || e.key === " ") {
            e.preventDefault();
            closeAboutModal();
        }
    });
    
    aboutModal.addEventListener("click", (e) => {
        if (e.target === aboutModal) {
            closeAboutModal();
        }
    });
    
    document.addEventListener("keydown", (e) => {
        if (e.key === "Escape" && aboutModal.classList.contains("visible")) {
            closeAboutModal();
        }
    });
    
    // Category filter with enhanced mobile support
    const categoryFilterIcon = document.getElementById("categoryFilter");
    const categoryFilterDropdown = document.getElementById("categoryFilterDropdown");
    let filterDropdownVisible = false;
    
    categoryFilterIcon.addEventListener("click", handleCategoryFilterToggle);
    categoryFilterIcon.addEventListener("keydown", function(e) {
        if (e.key === "Enter" || e.key === " ") {
            e.preventDefault();
            handleCategoryFilterToggle(e);
        }
    });
    
    function handleCategoryFilterToggle(e) {
        e.preventDefault();
        e.stopPropagation();
        
        if (filterDropdownVisible) {
            hideCategoryFilter();
        } else {
            showCategoryFilter(e);
        }
    }
    
    function showCategoryFilter(e) {
        const categories = [...new Set(tutorials.map(t => t.category))].sort();
        let dropdownContent = `<div class="filter-option ${currentCategoryFilter === '' ? 'active' : ''}" data-category="" role="option">All Categories</div>`;
        
        categories.forEach(cat => {
            dropdownContent += `<div class="filter-option ${currentCategoryFilter === cat ? 'active' : ''}" data-category="${cat}" role="option">${cat}</div>`;
        });
        
        categoryFilterDropdown.innerHTML = dropdownContent;
        
        // Enhanced positioning for mobile
        const rect = categoryFilterIcon.getBoundingClientRect();
        const container = document.querySelector('.container');
        const containerRect = container.getBoundingClientRect();
        const viewportWidth = window.innerWidth;
        
        if (viewportWidth <= 768) {
            // Center dropdown on mobile
            categoryFilterDropdown.style.left = "50%";
            categoryFilterDropdown.style.transform = "translateX(-50%)";
            categoryFilterDropdown.style.top = (rect.bottom - containerRect.top + 8) + "px";
        } else {
            categoryFilterDropdown.style.left = (rect.left - containerRect.left) + "px";
            categoryFilterDropdown.style.top = (rect.bottom - containerRect.top + 5) + "px";
            categoryFilterDropdown.style.transform = "none";
        }
        
        categoryFilterDropdown.classList.add("visible");
        categoryFilterIcon.classList.add("active");
        filterDropdownVisible = true;
        
        // Enhanced option handling
        categoryFilterDropdown.querySelectorAll('.filter-option').forEach(option => {
            option.addEventListener('click', handleFilterOptionClick);
            option.addEventListener('keydown', function(e) {
                if (e.key === "Enter" || e.key === " ") {
                    e.preventDefault();
                    handleFilterOptionClick.call(this, e);
                }
            });
            option.setAttribute('tabindex', '0');
        });
    }
    
    function handleFilterOptionClick(e) {
        const category = e.target.getAttribute('data-category');
        currentCategoryFilter = category;
        renderTable();
        setTimeout(addPreviewListeners, 100);
        hideCategoryFilter();
    }
    
    function hideCategoryFilter() {
        categoryFilterDropdown.classList.remove("visible");
        categoryFilterIcon.classList.remove("active");
        filterDropdownVisible = false;
    }
    
    document.addEventListener("click", (e) => {
        if (!categoryFilterIcon.contains(e.target) && !categoryFilterDropdown.contains(e.target)) {
            hideCategoryFilter();
        }
    });
    
    // Enhanced preview functionality
    const previewTooltip = document.getElementById("previewTooltip");
    let previewCache = new Map();
    let previewTimeout;
    let currentPreviewTarget = null;

    function fixImagePaths(htmlContent, filename) {
        const parser = new DOMParser();
        const doc = parser.parseFromString(htmlContent, 'text/html');
        
        const images = doc.querySelectorAll('img');
        
        images.forEach(img => {
            const src = img.getAttribute('src');
            if (src && src.startsWith('../')) {
                const newSrc = src.replace('../', '');
                img.setAttribute('src', newSrc);
            }
        });
        
        return doc.documentElement.innerHTML;
    }

    function extractQuestContent(htmlContent, filename) {
        const fixedHtmlContent = fixImagePaths(htmlContent, filename);
        
        const parser = new DOMParser();
        const doc = parser.parseFromString(fixedHtmlContent, 'text/html');
        
        let questItems = [];
        let questImages = [];
        
        let questContainer = null;
        
        const headings = doc.querySelectorAll('h1, h2, h3, h4, h5, h6');
        for (let heading of headings) {
            const text = heading.textContent || heading.innerText || '';
            const cleanText = text.trim().toUpperCase().replace(//g, '').replace(/:/g, '');
            
            if (cleanText === 'QUEST') {
                let nextElement = heading.nextElementSibling;
                while (nextElement && nextElement.textContent.trim().length === 0) {
                    nextElement = nextElement.nextElementSibling;
                }
                
                if (nextElement && nextElement.textContent.trim().length > 0) {
                    questContainer = nextElement;
                    break;
                }
                
                let parent = heading.parentElement;
                if (parent) {
                    let foundHeading = false;
                    let contentElements = [];
                    
                    for (let child of parent.children) {
                        if (child === heading) {
                            foundHeading = true;
                            continue;
                        }
                        if (foundHeading) {
                            if (child.tagName && child.tagName.match(/^H[1-6]$/)) {
                                break;
                            }
                            if (child.textContent.trim().length > 0) {
                                contentElements.push(child);
                            }
                        }
                    }
                    
                    if (contentElements.length > 0) {
                        questContainer = doc.createElement('div');
                        contentElements.forEach(el => questContainer.appendChild(el.cloneNode(true)));
                        break;
                    }
                }
            }
        }
        
        if (!questContainer) {
            const allElements = doc.querySelectorAll('*');
            for (let element of allElements) {
                const text = element.textContent || element.innerText || '';
                const cleanText = text.trim().toUpperCase().replace(//g, '').replace(/:/g, '');
                
                if (cleanText === 'QUEST' && text.length < 20) {
                    let nextElement = element.nextElementSibling;
                    while (nextElement && nextElement.textContent.trim().length === 0) {
                        nextElement = nextElement.nextElementSibling;
                    }
                    
                    if (nextElement && nextElement.textContent.trim().length > 0) {
                        questContainer = nextElement;
                        break;
                    }
                }
            }
        }
        
        if (questContainer) {
            const listItems = questContainer.querySelectorAll('li');
            
            if (listItems.length > 0) {
                listItems.forEach((item, index) => {
                    const itemText = (item.textContent || item.innerText || '').trim();
                    if (itemText && itemText.length > 5) {
                        questItems.push(itemText);
                    }
                });
            } else {
                const paragraphs = questContainer.querySelectorAll('p');
                
                if (paragraphs.length > 0) {
                    paragraphs.forEach((p, index) => {
                        const pText = (p.textContent || p.innerText || '').trim();
                        if (pText && pText.length > 10 && pText.length < 500) {
                            questItems.push(pText);
                        }
                    });
                } else {
                    const allText = questContainer.textContent || questContainer.innerText || '';
                    
                    let numberedItems = allText.split(/(?=\d+\.\s+[A-Z])/);
                    
                    if (numberedItems.length <= 2) {
                        const lines = allText.split(/\r?\n/).filter(line => line.trim().length > 0);
                        numberedItems = lines.filter(line => /^\d+\.\s+/.test(line.trim()));
                        
                        if (numberedItems.length === 0) {
                            const matches = allText.match(/\d+\.\s+[^.]*?(?=\d+\.|$)/g);
                            if (matches && matches.length > 0) {
                                numberedItems = matches;
                            }
                        }
                    }
                    
                    numberedItems.forEach((item, index) => {
                        const cleanItem = item.replace(/^\d+\.\s*/, '').trim();
                        if (cleanItem.length > 5) {
                            questItems.push(cleanItem);
                        }
                    });
                    
                    if (questItems.length === 0) {
                        const sentences = allText.split(/[.!?]+/).filter(s => s.trim().length > 10);
                        
                        sentences.forEach((sentence, index) => {
                            const cleanSentence = sentence.trim();
                            if (cleanSentence.length > 15 && (
                                cleanSentence.includes('What ') || 
                                cleanSentence.includes('How ') || 
                                cleanSentence.includes('To ') || 
                                cleanSentence.includes('Which ') ||
                                cleanSentence.includes('?')
                            )) {
                                questItems.push(cleanSentence);
                            }
                        });
                    }
                }
            }
            
            const images = questContainer.querySelectorAll('img');
            images.forEach(img => {
                const src = img.getAttribute('src');
                if (src) {
                    const fixedSrc = src.startsWith('../') ? src.replace('../', '') : src;
                    questImages.push({
                        src: fixedSrc,
                        alt: img.getAttribute('alt') || 'Quest image',
                        title: img.getAttribute('title') || ''
                    });
                }
            });
        }
        
        return { 
            items: questItems,
            images: questImages,
            found: questContainer !== null
        };
    }

    async function showPreview(element, filename) {
        currentPreviewTarget = element;
        
        const rect = element.getBoundingClientRect();
        const container = document.querySelector('.container');
        const containerRect = container.getBoundingClientRect();
        const viewportWidth = window.innerWidth;
        
        // Enhanced mobile positioning
        if (viewportWidth <= 768) {
            previewTooltip.style.left = "16px";
            previewTooltip.style.right = "16px";
            previewTooltip.style.width = "calc(100vw - 32px)";
            previewTooltip.style.maxWidth = "calc(100vw - 32px)";
            previewTooltip.style.top = (rect.bottom - containerRect.top + 10) + "px";
        } else {
            previewTooltip.style.left = (rect.left - containerRect.left) + "px";
            previewTooltip.style.top = (rect.bottom - containerRect.top + 10) + "px";
            previewTooltip.style.width = "";
            previewTooltip.style.right = "";
            previewTooltip.style.maxWidth = "500px";
        }
        
        previewTooltip.innerHTML = `
            <div class="preview-title">
                ${element.textContent}
            </div>
            <div class="loading">Loading quest preview...</div>
        `;
        previewTooltip.classList.add("visible");
        
        if (previewCache.has(filename)) {
            const cached = previewCache.get(filename);
            displayQuestPreview(element.textContent, cached);
            return;
        }
        
        try {
            const response = await fetch(`htmls/${filename}`);
            if (!response.ok) throw new Error('Failed to load');
            
            const htmlContent = await response.text();
            const questContent = extractQuestContent(htmlContent, filename);
            
            previewCache.set(filename, questContent);
            
            if (currentPreviewTarget === element) {
                displayQuestPreview(element.textContent, questContent);
            }
            
        } catch (error) {
            if (currentPreviewTarget === element) {
                previewTooltip.innerHTML = `
                    <div class="preview-title">
                        <span class="quest-icon"></span>
                        ${element.textContent}
                    </div>
                    <div class="error">Quest preview not available</div>
                `;
            }
        }
    }

    function displayQuestPreview(title, questContent) {
        let html = `
            <div class="preview-title">
                ${title}
            </div>
        `;
        
        if (!questContent.found) {
            html += `<div class="error">Quest preview not available</div>`;
        } else if (questContent.items && questContent.items.length > 0) {
            html += '<div class="quest-section">';
            
            questContent.items.forEach((item, index) => {
                const cleanItem = item.replace(/^\d+\.?\s*/, '').trim();
                html += `<div style="margin: 8px 0; color: var(--text-color);">${index + 1}. ${cleanItem}</div>`;
            });
            
            html += '</div>';
            
            if (questContent.images && questContent.images.length > 0) {
                html += '<div style="margin-top: 12px;">';
                questContent.images.forEach(image => {
                    html += `<img src="${image.src}" alt="${image.alt}" title="${image.title}" style="max-width: 100%; height: auto; max-height: 150px; border-radius: 4px; margin: 4px 0;">`;
                });
                html += '</div>';
            }
        } else {
            html += `<div class="error">No quest content found</div>`;
        }
        
        previewTooltip.innerHTML = html;
    }

    function hidePreview() {
        previewTooltip.classList.remove("visible");
        currentPreviewTarget = null;
    }

    function addPreviewListeners() {
        const topicLinks = document.querySelectorAll('#tutorialTable a');
        
        topicLinks.forEach(link => {
            const filename = link.getAttribute('href').replace('htmls/', '');
            
            // Use longer delay on mobile for better UX
            const isMobile = window.innerWidth <= 768;
            const showDelay = isMobile ? 800 : 500;
            const hideDelay = isMobile ? 300 : 200;
            
            link.addEventListener('mouseenter', () => {
                clearTimeout(previewTimeout);
                previewTimeout = setTimeout(() => {
                    showPreview(link, filename);
                }, showDelay);
            });
            
            link.addEventListener('mouseleave', () => {
                clearTimeout(previewTimeout);
                previewTimeout = setTimeout(() => {
                    hidePreview();
                }, hideDelay);
            });
            
            // Add touch support for mobile
            if (isMobile) {
                link.addEventListener('touchstart', () => {
                    clearTimeout(previewTimeout);
                    previewTimeout = setTimeout(() => {
                        showPreview(link, filename);
                    }, showDelay);
                });
            }
        });
    }

    previewTooltip.addEventListener('mouseenter', () => {
        clearTimeout(previewTimeout);
    });

    previewTooltip.addEventListener('mouseleave', () => {
        hidePreview();
    });
    
    // Enhanced request topic functionality
    function setupRequestTopicLink() {
        const requestLink = document.getElementById('requestTopicLink');
        
        requestLink.addEventListener('click', handleRequestTopicClick);
        requestLink.addEventListener('keydown', function(e) {
            if (e.key === "Enter" || e.key === " ") {
                e.preventDefault();
                handleRequestTopicClick();
            }
        });
    }
    
    function handleRequestTopicClick() {
        const searchValue = searchBox.value.trim();
        const capitalizedValue = searchValue.charAt(0).toUpperCase() + searchValue.slice(1);
        
        const baseUrl = "https://github.com/meluron-codecafe/DevQuest/issues/new";
        const params = new URLSearchParams({
            assignees: "ankit0anand0",
            labels: "tutorials",
            projects: "",
            template: "",
            title: searchValue ? `[TUTORIAL REQUEST] ${capitalizedValue}` : "[TUTORIAL REQUEST]"
        });
        window.open(`${baseUrl}?${params.toString()}`, "_blank");
    }
    
    // Load and render data
    fetch('tutorials.csv')
    .then(response => response.text())
    .then(data => {
        const parsed = Papa.parse(data, {
            header: true,
            skipEmptyLines: true
        });
        
        tutorials = parsed.data.map(row => ({
            category: row.category || '',
            topic: row.topic || '',
            keywords: row.keywords || '',
            filename: row.html || ''
        }));
        
        assignCategoryColors();
        renderTable();
        setupRequestTopicLink();
        
        setTimeout(addPreviewListeners, 100);
    });
    
    function renderTable() {
        const searchQuery = searchBox.value.toLowerCase();
        const tableBody = document.querySelector('#tutorialTable tbody');
        const noResultsDiv = document.getElementById('noResults');
        const tableWrapper = document.querySelector('.table-wrapper');
        
        tableBody.innerHTML = '';
        
        const filteredTutorials = tutorials.filter(t =>
            (!currentCategoryFilter || t.category.toLowerCase() === currentCategoryFilter.toLowerCase()) &&
            (!searchQuery || (t.topic + ' ' + t.keywords).toLowerCase().includes(searchQuery))
        );
        
        if (filteredTutorials.length === 0) {
            tableWrapper.style.display = 'none';
            noResultsDiv.style.display = 'block';
        } else {
            tableWrapper.style.display = 'block';
            noResultsDiv.style.display = 'none';
            
            filteredTutorials.forEach(t => {
                const tr = document.createElement('tr');
                const color = categoryColorMap[t.category] || "#ddd";
                tr.innerHTML = `
                <td class="category" style="color: ${color};" data-label="Category">
                    ${t.category}
                </td>
                <td data-label="Topic"><a href="htmls/${t.filename}" target="_blank">${t.topic}</a></td>
                <td data-label="Keywords">${t.keywords || '-'}</td>
            `;
                tableBody.appendChild(tr);
            });
        }
    }
    
    function initializeSearchInput() {
        if (searchBox) {
            searchBox.addEventListener('input', () => {
                renderTable();
                setTimeout(addPreviewListeners, 100);
            });
        }
    }
    
    setTimeout(initializeSearchInput, 100);
</script>

</body>
</html>